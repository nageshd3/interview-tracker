<h2>Add Interview</h2>

<form [formGroup]="interviewForm" (ngSubmit)="addInterview()" aria-labelledby="add-interview-title">
  <h3 id="add-interview-title" class="visually-hidden">
    Add a new interview
  </h3>

  <!-- Company -->
  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Company</mat-label>

    <input matInput formControlName="company" aria-required="true" aria-describedby="company-error" />

    @if (company?.invalid && company?.touched) {
    <mat-error id="company-error">
      @if (company?.hasError('required')) {
      Company name is required
      } @else if (company?.hasError('minLengthTrimmed')) {
      Company name must be at least 2 characters
      }
    </mat-error>
    }
  </mat-form-field>

  <!-- Role -->
  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Role</mat-label>

    <input matInput formControlName="role" aria-required="true" aria-describedby="role-error" />

    @if (role?.invalid && role?.touched) {
    <mat-error id="role-error">
      @if (role?.hasError('required')) {
      Role is required
      } @else if (role?.hasError('minLengthTrimmed')) {
      Role must be at least 2 characters
      }
    </mat-error>
    }
  </mat-form-field>

  <!-- Date -->
  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Interview Date</mat-label>

    <input matInput type="date" formControlName="date" aria-required="true" aria-describedby="date-error"
      [min]="today" />

    @if (date?.invalid && date?.touched) {
    <mat-error id="date-error">
      @if (date?.hasError('required')) {
      Interview date is required
      } @else if (date?.hasError('invalidDate')) {
      Invalid date format
      } @else if (date?.hasError('pastDate')) {
      Interview date cannot be in the past
      }
    </mat-error>
    }
  </mat-form-field>

  <button mat-raised-button color="primary" type="submit" [disabled]="interviewForm.invalid || isSubmitting">
    @if (!isSubmitting) {
    Add Interview
    } @else {
    <mat-spinner diameter="20"></mat-spinner>
    }
  </button>
</form>

<hr />

<h2>Interviews</h2>

<ul>
  @for (interview of interviews(); track interview.id) {
  <li>
    <a [routerLink]="['/interviews', interview.id]">
      {{ interview.company }} - {{ interview.role }}
    </a>
  </li>
  }
</ul>